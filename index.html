<!DOCTYPE html><html><head><title>Automated Survey</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Automated Survey"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Automated Survey</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Instantly collect structured data from your users with a survey conducted over a voice call or SMS text messages. Learn how to create your own survey in the language and framework of your choice.</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Application Setup" class="chapter"><div data-title="Introduction" data-file="package.json" data-highlight="" class="step"><h2 id="how-it-works">How It Works</h2>
<p>Implementing your own automated survey with Twilio Voice and SMS can be a huge time saver when you need to collect feedback from a group of people. Whether it&#39;s participants in a social services program or a field service organization, you can quickly set up your own survey to collect structured data over the phone or via text message. Here&#39;s how it works at a high level:</p>
<p><img src="//s3.amazonaws.com/howtodocs/automated-survey.png" alt="Automated Survey Diagram"></p>
<ol>
<li><p>The end user calls or texts the survey phone number. </p>
</li>
<li><p>Twilio gets the call or text and makes an HTTP request to your application for instructions on how to respond.</p>
</li>
<li><p>Your web application serves up <a href="/docs/api/twiml">TwiML instructions</a> to <code>Gather</code> or <code>Record</code> the user input over the phone, or prompt for text input with <code>Message</code>.</p>
</li>
<li><p>After each question, Twilio makes another request to your server with the user&#39;s input, which your application stores in its database.</p>
</li>
<li><p>Your application returns a TwiML response to Twilio with instructions to either ask the next question or end the survey.</p>
</li>
</ol>
<h2 id="what-we-will-learn">What We Will Learn</h2>
<p>This How-To demonstrates using TwiML to deliver a survey that can be completed via voice call. The survey actually works via SMS text messages, too, but we&#39;re going to focus on the looping logic necessary to conduct an interview over the phone. We will create a voice call flow using the <a href="/docs/api/twiml/say">Say</a>, <a href="/docs/api/twiml/record">Record</a> and <a href="/docs/api/twiml/gather">Gather</a> TwiML verbs.</p>
<p>You will also learn how to maintain conversation state in a database that spans multiple webhook requests. Beyond an automated survey, these techniques can be applied to implement more complex <a href="http://en.wikipedia.org/wiki/Interactive_voice_response">IVR</a> systems or text message interfaces.</p>
<p>Sound like a plan? Let&#39;s get started! Click the right arrow above this text to move on to the next step of the tutorial.</p>
</div><div data-title="About This Application" data-file="package.json" data-highlight="24-30" class="step"><h2 id="about-this-application">About This Application</h2>
<p>Like most Node.js web applications, this one relies on a number of smaller modules installed via <a href="http://npmjs.org">npm</a> to handle HTTP requests and store data. The key modules for this application are:</p>
<ul>
<li><a href="http://expressjs.com"><code>express</code></a> - a popular web framework that helps us respond to HTTP requests to our application.</li>
<li><a href="http://mongoosejs.com/"><code>mongoose</code></a> - an Object/Document Mapper (ODM) for <a href="http://www.mongodb.org/">MongoDB</a>.</li>
<li><a href="https://twilio.github.io/twilio-node"><code>twilio</code></a> - the Twilio Node module will help us generate TwiML responses to drive our interview.</li>
</ul>
<p>Let&#39;s check out the survey questions we want to ask next.</p>
</div><div data-title="Bootstrapping the Application" data-file="index.js" class="step"><h2 id="bootstrapping-the-application">Bootstrapping the Application</h2>
<p>This is the Node file we will execute to serve up our web application. We load our app&#39;s configuration from an external file containing the HTTP port we want to run on and the MongoDB database connection string we need to store data using Mongoose.</p>
<p>We also define four routes to be handled by our web application. Three of the routes are <a href="http://en.wikipedia.org/wiki/Webhook">webhooks</a> that will be requested by Twilio when your Twilio survey number receives an incoming call or text, or when the results of a transcription job are ready. The fourth route will be used by our reporting UI to get the results of the survey from the database.</p>
<p>Now that our application is all set up, let&#39;s look at the high level steps necessary to implement a voice interview via Twilio and TwiML.</p>
</div></div><div data-title="The Interview Loop" class="chapter"><div data-title="The Voice Interview Loop" data-file="routes/voice.js" data-highlight="" class="step"><h2 id="the-voice-interview-loop">The Voice Interview Loop</h2>
<p>It is helpful to visualize your interaction with a user during a survey as a loop. The chart below traces the flow of a user&#39;s phone call to your Twilio number to participate in the survey (click it to make it bigger):</p>
<p><img src="//s3.amazonaws.com/howtodocs/flowchart.png" alt="Survey Flow Chart"></p>
<p>The user can enter input for your survey over the phone using either their phone&#39;s keypad or by speaking. After each interaction, Twilio will make an HTTP request to your web application with either the string of keys the user pressed or a URL to a recording of their voice input.</p>
<p>It&#39;s up to our application to process and store the user&#39;s input, maintain the current state of the conversation, and respond back to the user. Let&#39;s dive into this flow to see how it actually works.</p>
</div><div data-title="Responding to a Phone Call" data-file="routes/voice.js" data-highlight="" class="step"><h2 id="responding-to-a-phone-call">Responding to a Phone Call</h2>
<p><img src="//s3.amazonaws.com/howtodocs/flowchart2.png" alt="Survey Flow Chart"></p>
<p>To initiate the interview process, we need to configure one of our <a href="/user/account/phone-numbers/incoming">Twilio numbers</a> to send our web application an HTTP request when we get an incoming call or text (remember, our app accepts text messages as well, even though we&#39;re focusing on the voice side).</p>
<p><a href="/user/account/phone-numbers/incoming">Click on one of your numbers</a> and configure Voice and Message URLs that point to your server. In our code, the routes were <code>/voice</code> and <code>/message</code>, respectively.</p>
<p><img src="//s3.amazonaws.com/howtodocs/number-config.png" alt="Configuring a Twilio Number"></p>
</div><div data-title="Responding to a Phone Call" data-file="routes/voice.js" data-highlight="5-9" class="step"><h2 id="responding-to-a-phone-call">Responding to a Phone Call</h2>
<p><img src="//s3.amazonaws.com/howtodocs/flowchart3.png" alt="Survey Flow Chart"></p>
<p>The <code>voice</code> route maps to this Express handler function, which takes an HTTP request and HTTP response as arguments. On the request, we can access the phone number of the person calling in the <code>From</code> POST parameter - we can use this to uniquely identify a person taking the survey. </p>
<p>We can also access the <code>RecordingUrl</code>, which contains any voice input from the user. If that&#39;s not present, <code>Digits</code> may also be present, which contains the string of keys entered by the user on their keypad. If this is the user&#39;s first call to our system or they failed to enter any input to the previous question, these values might be blank Strings. </p>
<p>We also create a <code>TwimlResponse</code> object that we will use to build up a string of XML we can ultimately render as a response to Twilio&#39;s request. It&#39;s not doing anything fancy - it just provides a JavaScript object that we can use to progressively assemble a valid TwiML string as our program executes.</p>
</div><div data-title="Asking a Question" data-file="routes/voice.js" data-highlight="11-48" class="step"><h2 id="asking-a-question">Asking a Question</h2>
<p><img src="//s3.amazonaws.com/howtodocs/flowchart4.png" alt="Survey Flow Chart"></p>
<p>If the user did not enter any input, it&#39;s the first question, or there&#39;s still another question after the current one, we will build a TwiML response that will ask the next question.</p>
<p>We define a few inner functions here to help us build our response. <code>respond</code> ends our TwiML response and sends XML content back to Twilio. <code>say</code> is a shorthand for appending a string of text that will be read back to the user with Twilio TTS (text-to-speech) engine.</p>
</div><div data-title="Asking a Question" data-file="routes/voice.js" data-highlight="50-75" class="step"><h2 id="asking-a-question">Asking a Question</h2>
<p><img src="//s3.amazonaws.com/howtodocs/flowchart4.png" alt="Survey Flow Chart"></p>
<p>In our TwiML response, we need to include either a <code>Gather</code> tag or a <code>Record</code> tag to collect input from the user. Which tag we use depends on the question type in the survey.</p>
<p>In the <code>Record</code> use case, we also provide a transcription callback URL. Unlike <code>Gather</code> and <code>Record</code>, the transcription callback happens outside the loop of the call, sometime in the very near future (several seconds rather than minutes). So while you can&#39;t count on having the transcript results during the flow of the call, you can add the transcript to your database record for the response to help enrich that data a bit.</p>
<p>Another caveat here is that Twilio&#39;s transcription service is automated and not always super accurate. If transcription accuracy is critical for you, you might consider using a service with human translators like <a href="https://www.rev.com/">Rev.com</a>.</p>
</div><div data-title="Updating Conversation State" data-file="routes/voice.js" data-highlight="22-27" class="step"><h2 id="updating-conversation-state">Updating Conversation State</h2>
<p><img src="//s3.amazonaws.com/howtodocs/flowchart5.png" alt="Survey Flow Chart"></p>
<p>Saving the user&#39;s response and maintaining the state of our conversation with the user is a concern best handled at the <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">model layer</a> of our server-side application, so we use our MongoDB-backed Mongoose model to handle this for us. </p>
<p>Abstracting the survey state from the controller also has the benefit of letting us re-use it for handling survey inputs from text messages. #winning!</p>
<p>Let&#39;s dive into the model object next to briefly examine how that works.</p>
</div><div data-title="The Mongoose Schema" data-file="models/SurveyResponse.js" data-highlight="1-16" class="step"><h2 id="the-mongoose-schema">The Mongoose Schema</h2>
<p><img src="//s3.amazonaws.com/howtodocs/flowchart5.png" alt="Survey Flow Chart"></p>
<p>In our model, we create a schema that allows us to constrain and validate the form of documents that we insert into MongoDB. However, the <code>Mixed</code> type lets us store arbitrary JavaScript objects in the <code>responses</code> array, so we have some flexibility there with the objects we use to store our user&#39;s answers.</p>
<p>Mongooses are pretty sweet.</p>
<p><img src="//s3.amazonaws.com/howtodocs/rikki.jpg" alt="Rikki Tikki Tavi">
<a href="http://en.wikipedia.org/wiki/Rikki-Tikki-Tavi">&lt;small&gt;Don&#39;t even.&lt;/small&gt;</a></p>
</div><div data-title="Storing Responses" data-file="models/SurveyResponse.js" data-highlight="52-77" class="step"><h2 id="storing-responses">Storing Responses</h2>
<p><img src="//s3.amazonaws.com/howtodocs/flowchart5.png" alt="Survey Flow Chart"></p>
<p>Prior to saving a response from the user, we convert the raw string values submitted into data types that will be easier for us to work with as we analyze and visualize our survey data.</p>
</div><div data-title="Queueing Up the Next Question" data-file="models/SurveyResponse.js" data-highlight="75-91" class="step"><h2 id="queueing-up-the-next-question">Queueing Up the Next Question</h2>
<p><img src="//s3.amazonaws.com/howtodocs/flowchart6.png" alt="Survey Flow Chart"></p>
<p>After the current response is saved, we invoke the callback to our controller with the index of the next question in the survey. This may be longer than the actual length of the survey, which means we&#39;re finished asking questions!</p>
<p>After you&#39;ve finished asking questions, you might be interested in seeing how people responded to your survey. We won&#39;t spend too much time on visualizing the data, but we&#39;ve included a bit of code in this sample app that shows you how you might approach that.</p>
</div></div><div data-title="Checking Out The Results" class="chapter"><div data-title="Checking Out The Results" data-file="public/index.html" data-highlight="" class="step"><h2 id="checking-out-the-results">Checking Out The Results</h2>
<p>In this app&#39;s static asset directory, you&#39;ll find an <code>index.html</code> file that contains some markup for displaying the results of our survey questions. It makes an Ajax request to our Express application to get the last 100 results from our survey to display here.</p>
<p>For phone survey responses, there is a link to listen to the recording in addition to the transcribed text sent to our application.</p>
</div><div data-title="Playing Twilio Recordings" data-file="public/index.js" data-highlight="49-73" class="step"><h2 id="playing-twilio-recordings">Playing Twilio Recordings</h2>
<p>In the JavaScript that dynamically inserts the recording links into the page, we open the same <code>RecordingUrl</code> sent to us from Twilio in a new window. This works well enough, but you might consider playing them directly on the page with a more robust audio library like <a href="http://buzz.jaysalvat.com/">Buzz</a>.  When preparing the recordings to be played via HTML 5 audio, note that each recording is made available <a href="https://www.twilio.com/docs/api/twiml/record#attributes-action-parameters">in either WAV or MP3 formats</a>.</p>
</div><div data-title="All Done!" data-file="public/index.js" data-highlight="" class="step"><h2 id="that-s-all-folks">That&#39;s All Folks</h2>
<p>When you load this page in your browser, you should be able to view the latest results of your awesome automated survey:</p>
<p><img src="//s3.amazonaws.com/howtodocs/survey-results.png" alt="Displaying Survey Results"></p>
<p>And that&#39;s it! You can reload your browser and watch as the results fly in from your users.</p>
<p>We hope you&#39;ve enjoyed this tutorial. If you have any questions or feedback, please contact <a href="mailto:deved@twilio.com">your pals at Twilio</a> - we&#39;d love to hear from you!</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="package.json" data-mode="json">ewogICJuYW1lIjogInN1cnZleS1ub2RlIiwKICAidmVyc2lvbiI6ICIxLjAuMCIsCiAgImRlc2NyaXB0aW9uIjogImFuIGF1dG9tYXRlZCBzdXJ2ZXkgY29uZHVjdGVkIHZpYSB2b2ljZSBhbmQgc21zIiwKICAibWFpbiI6ICJpbmRleC5qcyIsCiAgInNjcmlwdHMiOiB7CiAgICAidGVzdCI6ICJlY2hvIFwiRXJyb3I6IG5vIHRlc3Qgc3BlY2lmaWVkXCIgJiYgZXhpdCAxIgogIH0sCiAgInJlcG9zaXRvcnkiOiB7CiAgICAidHlwZSI6ICJnaXQiLAogICAgInVybCI6ICJodHRwczovL2dpdGh1Yi5jb20vVHdpbGlvRGV2RWQvc3VydmV5LW5vZGUiCiAgfSwKICAia2V5d29yZHMiOiBbCiAgICAidHdpbGlvIiwKICAgICJleHByZXNzIiwKICAgICJzdXJ2ZXkiCiAgXSwKICAiYXV0aG9yIjogIktldmluIFdoaW5uZXJ5IiwKICAibGljZW5zZSI6ICJNSVQiLAogICJidWdzIjogewogICAgInVybCI6ICJodHRwczovL2dpdGh1Yi5jb20vVHdpbGlvRGV2RWQvc3VydmV5LW5vZGUvaXNzdWVzIgogIH0sCiAgImhvbWVwYWdlIjogImh0dHBzOi8vZ2l0aHViLmNvbS9Ud2lsaW9EZXZFZC9zdXJ2ZXktbm9kZSIsCiAgImRlcGVuZGVuY2llcyI6IHsKICAgICJib2R5LXBhcnNlciI6ICJeMS4xMS4wIiwKICAgICJleHByZXNzIjogIl40LjExLjIiLAogICAgIm1vbmdvb3NlIjogIl4zLjguMjMiLAogICAgIm1vcmdhbiI6ICJeMS41LjEiLAogICAgInR3aWxpbyI6ICJeMS4xMC4wIgogIH0KfQo=</textarea>
<textarea class="saurus-file" data-file="index.js" data-mode="javascript">dmFyIGh0dHAgPSByZXF1aXJlKCdodHRwJyk7CnZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpOwp2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKdmFyIG1vcmdhbiA9IHJlcXVpcmUoJ21vcmdhbicpOwp2YXIgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpOwp2YXIgdXJsZW5jb2RlZCA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJykudXJsZW5jb2RlZDsKdmFyIGNvbmZpZyA9IHJlcXVpcmUoJy4vY29uZmlnJyk7CnZhciB2b2ljZSA9IHJlcXVpcmUoJy4vcm91dGVzL3ZvaWNlJyk7CnZhciBtZXNzYWdlID0gcmVxdWlyZSgnLi9yb3V0ZXMvbWVzc2FnZScpOwp2YXIgcmVzdWx0cyA9IHJlcXVpcmUoJy4vcm91dGVzL3Jlc3VsdHMnKTsKCi8vIGluaXRpYWxpemUgTW9uZ29EQiBjb25uZWN0aW9uCm1vbmdvb3NlLmNvbm5lY3QoY29uZmlnLm1vbmdvVXJsKTsKCi8vIENyZWF0ZSBFeHByZXNzIHdlYiBhcHAgd2l0aCBzb21lIHVzZWZ1bCBtaWRkbGV3YXJlCnZhciBhcHAgPSBleHByZXNzKCk7CmFwcC51c2UoZXhwcmVzcy5zdGF0aWMocGF0aC5qb2luKF9fZGlybmFtZSwgJ3B1YmxpYycpKSk7CmFwcC51c2UodXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlIH0pKTsKYXBwLnVzZShtb3JnYW4oJ2NvbWJpbmVkJykpOwoKLy8gVHdpbGlvIFdlYmhvb2sgcm91dGVzCmFwcC5wb3N0KCcvdm9pY2UnLCB2b2ljZS5pbnRlcnZpZXcpOwphcHAucG9zdCgnL3ZvaWNlLzpyZXNwb25zZUlkL3RyYW5zY3JpYmUvOnF1ZXN0aW9uSW5kZXgnLCB2b2ljZS50cmFuc2NyaXB0aW9uKTsKYXBwLnBvc3QoJy9tZXNzYWdlJywgbWVzc2FnZSk7CgovLyBBamF4IHJvdXRlIHRvIGFnZ3JlZ2F0ZSByZXNwb25zZSBkYXRhIGZvciB0aGUgVUkKYXBwLmdldCgnL3Jlc3VsdHMnLCByZXN1bHRzKTsKCi8vIENyZWF0ZSBIVFRQIHNlcnZlciBhbmQgbW91bnQgRXhwcmVzcyBhcHAKdmFyIHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGFwcCk7CnNlcnZlci5saXN0ZW4oY29uZmlnLnBvcnQsIGZ1bmN0aW9uKCkgewogICAgY29uc29sZS5sb2coJ0V4cHJlc3Mgc2VydmVyIHN0YXJ0ZWQgb24gKjonK2NvbmZpZy5wb3J0KTsKfSk7</textarea>
<textarea class="saurus-file" data-file="routes/voice.js" data-mode="javascript">dmFyIHR3aWxpbyA9IHJlcXVpcmUoJ3R3aWxpbycpOwp2YXIgU3VydmV5UmVzcG9uc2UgPSByZXF1aXJlKCcuLi9tb2RlbHMvU3VydmV5UmVzcG9uc2UnKTsKdmFyIHN1cnZleSA9IHJlcXVpcmUoJy4uL3N1cnZleV9kYXRhJyk7CgovLyBFeHByZXNzIHJvdXRlIGhhbmRsZXIgZm9yIHRoZSBtYWluIGludGVydmlldyBsb29wCmV4cG9ydHMuaW50ZXJ2aWV3ID0gZnVuY3Rpb24ocmVxdWVzdCwgcmVzcG9uc2UpIHsKICAgIHZhciBwaG9uZSA9IHJlcXVlc3QuYm9keS5Gcm9tOwogICAgdmFyIGlucHV0ID0gcmVxdWVzdC5ib2R5LlJlY29yZGluZ1VybCB8fCByZXF1ZXN0LmJvZHkuRGlnaXRzOwogICAgdmFyIHR3aW1sID0gbmV3IHR3aWxpby5Ud2ltbFJlc3BvbnNlKCk7CgogICAgLy8gaGVscGVyIHRvIGFwcGVuZCBhIG5ldyAiU2F5IiB2ZXJiIHdpdGggYWxpY2Ugdm9pY2UKICAgIGZ1bmN0aW9uIHNheSh0ZXh0KSB7CiAgICAgICAgdHdpbWwuc2F5KHRleHQsIHsgdm9pY2U6ICdhbGljZSd9KTsKICAgIH0KCiAgICAvLyByZXNwb25kIHdpdGggdGhlIGN1cnJlbnQgVHdpTUwgY29udGVudAogICAgZnVuY3Rpb24gcmVzcG9uZCgpIHsKICAgICAgICByZXNwb25zZS50eXBlKCd0ZXh0L3htbCcpOwogICAgICAgIHJlc3BvbnNlLnNlbmQodHdpbWwudG9TdHJpbmcoKSk7CiAgICB9CgogICAgLy8gRmluZCBhbiBpbi1wcm9nZXNzIHN1cnZleSBpZiBvbmUgZXhpc3RzLCBvdGhlcndpc2UgY3JlYXRlIG9uZQogICAgU3VydmV5UmVzcG9uc2UuYWR2YW5jZVN1cnZleSh7CiAgICAgICAgcGhvbmU6IHBob25lLAogICAgICAgIGlucHV0OiBpbnB1dCwKICAgICAgICBzdXJ2ZXk6IHN1cnZleQogICAgfSwgZnVuY3Rpb24oZXJyLCBzdXJ2ZXlSZXNwb25zZSwgcXVlc3Rpb25JbmRleCkgewogICAgICAgIHZhciBxdWVzdGlvbiA9IHN1cnZleVtxdWVzdGlvbkluZGV4XTsKCiAgICAgICAgaWYgKGVyciB8fCAhc3VydmV5UmVzcG9uc2UpIHsKICAgICAgICAgICAgc2F5KCdUZXJyaWJseSBzb3JyeSwgYnV0IGFuIGVycm9yIGhhcyBvY2N1cnJlZC4gR29vZGJ5ZS4nKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbmQoKTsKICAgICAgICB9CgogICAgICAgIC8vIElmIHF1ZXN0aW9uIGlzIG51bGwsIHdlJ3JlIGRvbmUhCiAgICAgICAgaWYgKCFxdWVzdGlvbikgewogICAgICAgICAgICBzYXkoJ1RoYW5rIHlvdSBmb3IgdGFraW5nIHRoaXMgc3VydmV5LiBHb29kYnllIScpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uZCgpOwogICAgICAgIH0KCiAgICAgICAgLy8gQWRkIGEgZ3JlZXRpbmcgaWYgdGhpcyBpcyB0aGUgZmlyc3QgcXVlc3Rpb24KICAgICAgICBpZiAocXVlc3Rpb25JbmRleCA9PT0gMCkgewogICAgICAgICAgICBzYXkoJ1RoYW5rIHlvdSBmb3IgdGFraW5nIG91ciBzdXJ2ZXkuIFBsZWFzZSBsaXN0ZW4gY2FyZWZ1bGx5ICcKICAgICAgICAgICAgICAgICsgJ3RvIHRoZSBmb2xsb3dpbmcgcXVlc3Rpb25zLicpOwogICAgICAgIH0KCiAgICAgICAgLy8gT3RoZXJ3aXNlLCBhc2sgdGhlIG5leHQgcXVlc3Rpb24KICAgICAgICBzYXkocXVlc3Rpb24udGV4dCk7CgogICAgICAgIC8vIERlcGVuZGluZyBvbiB0aGUgdHlwZSBvZiBxdWVzdGlvbiwgd2UgZWl0aGVyIG5lZWQgdG8gZ2V0IGlucHV0IHZpYQogICAgICAgIC8vIERUTUYgdG9uZXMgb3IgcmVjb3JkZWQgc3BlZWNoCiAgICAgICAgaWYgKHF1ZXN0aW9uLnR5cGUgPT09ICd0ZXh0JykgewogICAgICAgICAgICBzYXkoJ1BsZWFzZSByZWNvcmQgeW91ciByZXNwb25zZSBhZnRlciB0aGUgYmVlcC4gJwogICAgICAgICAgICAgICAgKyAnUHJlc3MgYW55IGtleSB0byBmaW5pc2guJyk7CiAgICAgICAgICAgIHR3aW1sLnJlY29yZCh7CiAgICAgICAgICAgICAgICB0cmFuc2NyaWJlOiB0cnVlLAogICAgICAgICAgICAgICAgdHJhbnNjcmliZUNhbGxiYWNrOiAnL3ZvaWNlLycgKyBzdXJ2ZXlSZXNwb25zZS5faWQKICAgICAgICAgICAgICAgICAgICArICcvdHJhbnNjcmliZS8nICsgcXVlc3Rpb25JbmRleCwKICAgICAgICAgICAgICAgIG1heExlbmd0aDogNjAKICAgICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChxdWVzdGlvbi50eXBlID09PSAnYm9vbGVhbicpIHsKICAgICAgICAgICAgc2F5KCdQcmVzcyBvbmUgZm9yICJ5ZXMiLCBhbmQgYW55IG90aGVyIGtleSBmb3IgIm5vIi4nKTsKICAgICAgICAgICAgdHdpbWwuZ2F0aGVyKHsKICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDEwLAogICAgICAgICAgICAgICAgbnVtRGlnaXRzOiAxCiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIE9ubHkgb3RoZXIgc3VwcG9ydGVkIHR5cGUgaXMgbnVtYmVyCiAgICAgICAgICAgIHNheSgnRW50ZXIgdGhlIG51bWJlciB1c2luZyB0aGUgbnVtYmVyIGtleXMgb24geW91ciB0ZWxlcGhvbmUuJyAKICAgICAgICAgICAgICAgICsgJyBQcmVzcyBzdGFyIHRvIGZpbmlzaC4nKTsKICAgICAgICAgICAgdHdpbWwuZ2F0aGVyKHsKICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDEwLAogICAgICAgICAgICAgICAgZmluaXNoT25LZXk6ICcqJwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8vIHJlbmRlciBUd2lNTCByZXNwb25zZQogICAgICAgIHJlc3BvbmQoKTsKICAgIH0pOwp9OwoKLy8gVHJhbnNjcmlwdG9uIGNhbGxiYWNrIC0gY2FsbGVkIGJ5IFR3aWxpbyB3aXRoIHRyYW5zY3JpcHQgb2YgcmVjb3JkaW5nCi8vIFdpbGwgdXBkYXRlIHN1cnZleSByZXNwb25zZSBvdXRzaWRlIHRoZSBpbnRlcnZpZXcgY2FsbCBmbG93CmV4cG9ydHMudHJhbnNjcmlwdGlvbiA9IGZ1bmN0aW9uKHJlcXVlc3QsIHJlc3BvbnNlKSB7CiAgICB2YXIgcmVzcG9uc2VJZCA9IHJlcXVlc3QucGFyYW1zLnJlc3BvbnNlSWQ7CiAgICB2YXIgcXVlc3Rpb25JbmRleCA9IHJlcXVlc3QucGFyYW1zLnF1ZXN0aW9uSW5kZXg7CiAgICB2YXIgdHJhbnNjcmlwdCA9IHJlcXVlc3QuYm9keS5UcmFuc2NyaXB0aW9uVGV4dDsKCiAgICBTdXJ2ZXlSZXNwb25zZS5maW5kQnlJZChyZXNwb25zZUlkLCBmdW5jdGlvbihlcnIsIHN1cnZleVJlc3BvbnNlKSB7CiAgICAgICAgaWYgKGVyciB8fCAhc3VydmV5UmVzcG9uc2UgfHwgCiAgICAgICAgICAgICFzdXJ2ZXlSZXNwb25zZS5yZXNwb25zZXNbcXVlc3Rpb25JbmRleF0pIAogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDUwMCkuZW5kKCk7CgogICAgICAgIC8vIFVwZGF0ZSBhcHByb3ByaWF0ZSBhbnN3ZXIgZmllbGQKICAgICAgICBzdXJ2ZXlSZXNwb25zZS5yZXNwb25zZXNbcXVlc3Rpb25JbmRleF0uYW5zd2VyID0gdHJhbnNjcmlwdDsKICAgICAgICBzdXJ2ZXlSZXNwb25zZS5tYXJrTW9kaWZpZWQoJ3Jlc3BvbnNlcycpOwogICAgICAgIHN1cnZleVJlc3BvbnNlLnNhdmUoZnVuY3Rpb24oZXJyLCBkb2MpIHsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1cyhlcnIgPyA1MDAgOiAyMDApLmVuZCgpOwogICAgICAgIH0pOwogICAgfSk7Cn07Cg==</textarea>
<textarea class="saurus-file" data-file="models/SurveyResponse.js" data-mode="javascript">dmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTsKCi8vIERlZmluZSBzdXJ2ZXkgcmVzcG9uc2UgbW9kZWwgc2NoZW1hCnZhciBTdXJ2ZXlSZXNwb25zZVNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoewogICAgLy8gcGhvbmUgbnVtYmVyIG9mIHBhcnRpY2lwYW50CiAgICBwaG9uZTogU3RyaW5nLAoKICAgIC8vIHN0YXR1cyBvZiB0aGUgcGFydGljaXBhbnQncyBjdXJyZW50IHN1cnZleSByZXNwb25zZQogICAgY29tcGxldGU6IHsKICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAoKICAgIC8vIHJlY29yZCBvZiBhbnN3ZXJzCiAgICByZXNwb25zZXM6IFttb25nb29zZS5TY2hlbWEuVHlwZXMuTWl4ZWRdCn0pOwoKLy8gRm9yIHRoZSBnaXZlbiBwaG9uZSBudW1iZXIgYW5kIHN1cnZleSwgYWR2YW5jZSB0aGUgc3VydmV5IHRvIHRoZSBuZXh0Ci8vIHF1ZXN0aW9uClN1cnZleVJlc3BvbnNlU2NoZW1hLnN0YXRpY3MuYWR2YW5jZVN1cnZleSA9IGZ1bmN0aW9uKGFyZ3MsIGNiKSB7CiAgICB2YXIgc3VydmV5RGF0YSA9IGFyZ3Muc3VydmV5OwogICAgdmFyIHBob25lID0gYXJncy5waG9uZTsKICAgIHZhciBpbnB1dCA9IGFyZ3MuaW5wdXQ7CiAgICB2YXIgc3VydmV5UmVzcG9uc2U7CgogICAgLy8gRmluZCBjdXJyZW50IGluY29tcGxldGUgc3VydmV5CiAgICBTdXJ2ZXlSZXNwb25zZS5maW5kT25lKHsKICAgICAgICBwaG9uZTogcGhvbmUsCiAgICAgICAgY29tcGxldGU6IGZhbHNlCiAgICB9LCBmdW5jdGlvbihlcnIsIGRvYykgewogICAgICAgIHN1cnZleVJlc3BvbnNlID0gZG9jIHx8IG5ldyBTdXJ2ZXlSZXNwb25zZSh7CiAgICAgICAgICAgIHBob25lOiBwaG9uZQogICAgICAgIH0pOwogICAgICAgIHByb2Nlc3NJbnB1dCgpOwogICAgfSk7CgogICAgLy8gZmlsbCBpbiBhbnkgYW5zd2VyIHRvIHRoZSBjdXJyZW50IHF1ZXN0aW9uLCBhbmQgZGV0ZXJtaW5lIG5leHQgcXVlc3Rpb24KICAgIC8vIHRvIGFzawogICAgZnVuY3Rpb24gcHJvY2Vzc0lucHV0KCkgewogICAgICAgIC8vIElmIHdlIGhhdmUgaW5wdXQsIHVzZSBpdCB0byBhbnN3ZXIgdGhlIGN1cnJlbnQgcXVlc3Rpb24KICAgICAgICB2YXIgcmVzcG9uc2VMZW5ndGggPSBzdXJ2ZXlSZXNwb25zZS5yZXNwb25zZXMubGVuZ3RoCiAgICAgICAgdmFyIGN1cnJlbnRRdWVzdGlvbiA9IHN1cnZleURhdGFbcmVzcG9uc2VMZW5ndGhdOwoKICAgICAgICAvLyBpZiB0aGVyZSdzIGEgcHJvYmxlbSB3aXRoIHRoZSBpbnB1dCwgd2UgY2FuIHJlLWFzayB0aGUgc2FtZSBxdWVzdGlvbgogICAgICAgIGZ1bmN0aW9uIHJlYXNrKCkgewogICAgICAgICAgICBjYi5jYWxsKHN1cnZleVJlc3BvbnNlLCBudWxsLCBzdXJ2ZXlSZXNwb25zZSwgcmVzcG9uc2VMZW5ndGgpOwogICAgICAgIH0KCiAgICAgICAgLy8gSWYgd2UgaGF2ZSBubyBpbnB1dCwgYXNrIHRoZSBjdXJyZW50IHF1ZXN0aW9uIGFnYWluCiAgICAgICAgaWYgKCFpbnB1dCkgcmV0dXJuIHJlYXNrKCk7CgogICAgICAgIC8vIE90aGVyd2lzZSB1c2UgdGhlIGlucHV0IHRvIGFuc3dlciB0aGUgY3VycmVudCBxdWVzdGlvbgogICAgICAgIHZhciBxdWVzdGlvblJlc3BvbnNlID0ge307CiAgICAgICAgaWYgKGN1cnJlbnRRdWVzdGlvbi50eXBlID09PSAnYm9vbGVhbicpIHsKICAgICAgICAgICAgLy8gQW55dGhpbmcgb3RoZXIgdGhhbiAnMScgb3IgJ3llcycgaXMgYSBmYWxzZQogICAgICAgICAgICB2YXIgaXNUcnVlID0gaW5wdXQgPT09ICcxJyB8fCBpbnB1dC50b0xvd2VyQ2FzZSgpID09PSAneWVzJzsKICAgICAgICAgICAgcXVlc3Rpb25SZXNwb25zZS5hbnN3ZXIgPSBpc1RydWU7CiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50UXVlc3Rpb24udHlwZSA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgLy8gVHJ5IGFuZCBjYXN0IHRvIGEgTnVtYmVyCiAgICAgICAgICAgIHZhciBudW0gPSBOdW1iZXIoaW5wdXQpOwogICAgICAgICAgICBpZiAoaXNOYU4obnVtKSkgewogICAgICAgICAgICAgICAgLy8gZG9uJ3QgdXBkYXRlIHRoZSBzdXJ2ZXkgcmVzcG9uc2UsIHJldHVybiB0aGUgc2FtZSBxdWVzdGlvbgogICAgICAgICAgICAgICAgcmV0dXJuIHJlYXNrKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBxdWVzdGlvblJlc3BvbnNlLmFuc3dlciA9IG51bTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoaW5wdXQuaW5kZXhPZignaHR0cCcpID09PSAwKSB7CiAgICAgICAgICAgIC8vIGlucHV0IGlzIGEgcmVjb3JkaW5nIFVSTAogICAgICAgICAgICBxdWVzdGlvblJlc3BvbnNlLnJlY29yZGluZ1VybCA9IGlucHV0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIG90aGVyd2lzZSBzdG9yZSByYXcgdmFsdWUKICAgICAgICAgICAgcXVlc3Rpb25SZXNwb25zZS5hbnN3ZXIgPSBpbnB1dDsKICAgICAgICB9CgogICAgICAgIC8vIFNhdmUgdHlwZSBmcm9tIHF1ZXN0aW9uCiAgICAgICAgcXVlc3Rpb25SZXNwb25zZS50eXBlID0gY3VycmVudFF1ZXN0aW9uLnR5cGU7CiAgICAgICAgc3VydmV5UmVzcG9uc2UucmVzcG9uc2VzLnB1c2gocXVlc3Rpb25SZXNwb25zZSk7CgogICAgICAgIC8vIElmIG5ldyByZXNwb25zZXMgbGVuZ3RoIGlzIHRoZSBsZW5ndGggb2Ygc3VydmV5LCBtYXJrIGFzIGRvbmUKICAgICAgICBpZiAoc3VydmV5UmVzcG9uc2UucmVzcG9uc2VzLmxlbmd0aCA9PT0gc3VydmV5RGF0YS5sZW5ndGgpIHsKICAgICAgICAgICAgc3VydmV5UmVzcG9uc2UuY29tcGxldGUgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgLy8gU2F2ZSByZXNwb25zZQogICAgICAgIHN1cnZleVJlc3BvbnNlLnNhdmUoZnVuY3Rpb24oZXJyKSB7CiAgICAgICAgICAgIGlmIChlcnIpIHsKICAgICAgICAgICAgICAgIHJlYXNrKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjYi5jYWxsKHN1cnZleVJlc3BvbnNlLCBlcnIsIHN1cnZleVJlc3BvbnNlLCByZXNwb25zZUxlbmd0aCsxKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQp9OwoKLy8gRXhwb3J0IG1vZGVsCnZhciBTdXJ2ZXlSZXNwb25zZSA9IG1vbmdvb3NlLm1vZGVsKCdTdXJ2ZXlSZXNwb25zZScsIFN1cnZleVJlc3BvbnNlU2NoZW1hKTsKbW9kdWxlLmV4cG9ydHMgPSBTdXJ2ZXlSZXNwb25zZTsK</textarea>
<textarea class="saurus-file" data-file="public/index.html" data-mode="html">PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5BdXRvbWF0ZWQgU3VydmV5czwvdGl0bGU+CiAgICA8bGluayByZWw9InNob3J0Y3V0IGljb24iIAogICAgICAgIGhyZWY9Ii8vdHdpbGlvLmNvbS9idW5kbGVzL21hcmtldGluZy9pbWcvZmF2aWNvbnMvZmF2aWNvbi5pY28iPgogICAgPGxpbmsgcmVsPSJhcHBsZS10b3VjaC1pY29uIiAKICAgICAgICBocmVmPSIvL3R3aWxpby5jb20vYnVuZGxlcy9tYXJrZXRpbmcvaW1nL2Zhdmljb25zL2Zhdmljb25fNTcucG5nIj4KICAgIDxsaW5rIHJlbD0iYXBwbGUtdG91Y2gtaWNvbiIgc2l6ZXM9IjcyeDcyIiAKICAgICAgICBocmVmPSIvL3R3aWxpby5jb20vL2J1bmRsZXMvbWFya2V0aW5nL2ltZy9mYXZpY29ucy9mYXZpY29uXzcyLnBuZyI+CiAgICA8bGluayByZWw9ImFwcGxlLXRvdWNoLWljb24iIHNpemVzPSIxMTR4MTE0IiAKICAgICAgICBocmVmPSIvL3R3aWxpby5jb20vYnVuZGxlcy9tYXJrZXRpbmcvaW1nL2Zhdmljb25zL2Zhdmljb25fMTE0LnBuZyI+CgogICAgPCEtLSBDU1MgRGVwZW5kZW5jaWVzIC0tPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IgogICAgICAgIGhyZWY9Ii8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vYm9vdHN0cmFwLzMuMy4yL2Nzcy9ib290c3RyYXAubWluLmNzcyI+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIAogICAgICAgIGhyZWY9Ii8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuMy4wL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyI+CgogICAgPCEtLSBBcHAgQ1NTIC0tPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJtYWluLmNzcyI+CjwvaGVhZD4KPGJvZHk+Cgo8IS0tIEFwcCBMYXlvdXQgLS0+CjxzZWN0aW9uIGlkPSJtYWluIiBjbGFzcz0iY29udGFpbmVyIj4KICAgIDxoMT5BdXRvbWF0ZWQgU3VydmV5IFJlc3VsdHM8L2gxPgogICAgPHA+CiAgICAgICAgV2FudCB0byBkaXNwbGF5IHRoZSByZXN1bHRzIG9mIHlvdXIgYXdlc29tZSBUd2lsaW8gc3VydmV5PyBIZXJlJ3MKICAgICAgICBob3cgeW91IG1pZ2h0IGRvIHRoYXQuCiAgICA8L3A+CgogICAgPGgzPlNob3dpbmcgPHNwYW4gaWQ9InRvdGFsIj48L3NwYW4+IFRvdGFsIFJlc3BvbnNlczwvaDM+CiAgICA8aHIvPgoKICAgIDxkaXYgY2xhc3M9InJvdyI+CiAgICAgICAgPGRpdiBjbGFzcz0iY29sLXNtLTYiPgogICAgICAgICAgICA8aDM+IlBsZWFzZSB0ZWxsIHVzIHlvdXIgYWdlLiI8L2gzPgogICAgICAgICAgICA8Y2FudmFzIGlkPSJhZ2VDaGFydCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIzMDAiPjwvY2FudmFzPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9ImNvbC1zbS02Ij4KICAgICAgICAgICAgPGgzPiJIYXZlIHlvdSBldmVyIGp1bXAta2lja2VkIGEgbGVtdXI/IjwvaDM+CiAgICAgICAgICAgIDxjYW52YXMgaWQ9ImxlbXVyQ2hhcnQiIHdpZHRoPSIzMDAiIGhlaWdodD0iMzAwIj48L2NhbnZhcz4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9InJvdyI+CiAgICAgICAgPGgzPiJXaG8gaXMgeW91ciBmYXZvcml0ZSBOaW5qYSBUdXJ0bGUgYW5kIHdoeT8iPC9oMz4KICAgICAgICA8dGFibGUgaWQ9InR1cnRsZVJlc3BvbnNlcyI+CiAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICAgIDx0aD5SZXNwb25zZSBUZXh0IC8gVHJhbnNjcmlwdDwvdGg+CiAgICAgICAgICAgICAgICA8dGg+UmVjb3JkaW5nPC90aD4KICAgICAgICAgICAgPC90cj4KICAgICAgICA8L3RhYmxlPgogICAgPC9kaXY+Cgo8L3NlY3Rpb24+Cgo8Zm9vdGVyIGNsYXNzPSJjb250YWluZXIiPgogICAgTWFkZSB3aXRoIDxpIGNsYXNzPSJmYSBmYS1oZWFydCI+PC9pPiBieSB5b3VyIHBhbHMKICAgIDxhIGhyZWY9Imh0dHA6Ly93d3cudHdpbGlvLmNvbSI+QHR3aWxpbzwvYT4KPC9mb290ZXI+Cgo8IS0tIEpTIERlcGVuZGVuY2llcyAtLT4KPHNjcmlwdCBzcmM9Ii8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzEuMTEuMi9qcXVlcnkubWluLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImNoYXJ0LmpzIj48L3NjcmlwdD4KCjwhLS0gQXBwIHNjcmlwdCAtLT4KPHNjcmlwdCBzcmM9ImluZGV4LmpzIj48L3NjcmlwdD4KCjwvYm9keT4KPC9odG1sPg==</textarea>
<textarea class="saurus-file" data-file="public/index.js" data-mode="javascript">JChmdW5jdGlvbigpIHsKCiAgICAvLyBDaGFydCBhZ2VzCiAgICBmdW5jdGlvbiBhZ2VzKHJlc3VsdHMpIHsKICAgICAgICAvLyBDb2xsZWN0IGFnZSByZXN1bHRzCiAgICAgICAgdmFyIGRhdGEgPSB7fTsKICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHJlc3VsdHMubGVuZ3RoOyBpPGw7IGkrKykgewogICAgICAgICAgICB2YXIgYWdlUmVzcG9uc2UgPSByZXN1bHRzW2ldLnJlc3BvbnNlc1swXTsKICAgICAgICAgICAgdmFyIGsgPSBTdHJpbmcoYWdlUmVzcG9uc2UuYW5zd2VyKTsKICAgICAgICAgICAgaWYgKCFkYXRhW2tdKSBkYXRhW2tdID0gMTsKICAgICAgICAgICAgZWxzZSBkYXRhW2tdKys7CiAgICAgICAgfQoKICAgICAgICAvLyBBc3NlbWJsZSBmb3IgZ3JhcGgKICAgICAgICB2YXIgbGFiZWxzID0gT2JqZWN0LmtleXMoZGF0YSk7CiAgICAgICAgdmFyIGRhdGFTZXQgPSBbXTsKICAgICAgICBmb3IgKHZhciBrIGluIGRhdGEpCiAgICAgICAgICAgIGRhdGFTZXQucHVzaChkYXRhW2tdKTsKCiAgICAgICAgLy8gUmVuZGVyIGNoYXJ0CiAgICAgICAgdmFyIGN0eCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZ2VDaGFydCcpLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgdmFyIGFnZUNoYXJ0ID0gbmV3IENoYXJ0KGN0eCkuQmFyKHsKICAgICAgICAgICAgbGFiZWxzOiBsYWJlbHMsCiAgICAgICAgICAgIGRhdGFzZXRzOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdBZ2VzJywKICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhU2V0CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0KICAgICAgICB9KTsKICAgIH0KCiAgICAvLyBDaGFydCB5ZXMvbm8gcmVzcG9uc2VzIHRvIGxlbXVyIHF1ZXN0aW9uCiAgICBmdW5jdGlvbiBsZW11cnMocmVzdWx0cykgewogICAgICAgIC8vIENvbGxlY3QgbGVtdXIga2lja2luZyByZXN1bHRzCiAgICAgICAgdmFyIHllcyA9IDAsIG5vID0gMDsKICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHJlc3VsdHMubGVuZ3RoOyBpPGw7IGkrKykgewogICAgICAgICAgICB2YXIgbGVtdXJSZXNwb25zZSA9IHJlc3VsdHNbaV0ucmVzcG9uc2VzWzFdOwogICAgICAgICAgICBsZW11clJlc3BvbnNlLmFuc3dlciA/IHllcysrIDogbm8rKzsKICAgICAgICB9CgogICAgICAgIHZhciBjdHggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVtdXJDaGFydCcpLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgdmFyIGFnZUNoYXJ0ID0gbmV3IENoYXJ0KGN0eCkuUGllKFsKICAgICAgICAgICAgeyB2YWx1ZTogeWVzLCBsYWJlbDogJ1llcycsIGNvbG9yOiAnZ3JlZW4nLCBoaWdobGlnaHQ6ICdncmF5JyB9LAogICAgICAgICAgICB7IHZhbHVlOiBubywgbGFiZWw6ICdObycsIGNvbG9yOiAncmVkJywgaGlnaGxpZ2h0OiAnZ3JheScgfQogICAgICAgIF0pOwogICAgfQoKICAgIC8vIHBvb3IgbWFuJ3MgaHRtbCB0ZW1wbGF0ZSBmb3IgYSByZXNwb25zZSB0YWJsZSByb3cKICAgIGZ1bmN0aW9uIHJvdyhyZXNwb25zZSkgewogICAgICAgIHZhciB0cGwgPSAnPHRyPjx0ZD4nOwogICAgICAgIHRwbCArPSByZXNwb25zZS5hbnN3ZXIgfHwgJ3BlbmRpbmcuLi4nICsgJzwvdGQ+JzsKICAgICAgICBpZiAocmVzcG9uc2UucmVjb3JkaW5nVXJsKSB7CiAgICAgICAgICAgIHRwbCArPSAnPHRkPjxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSInCiAgICAgICAgICAgICAgICArIHJlc3BvbnNlLnJlY29yZGluZ1VybCAKICAgICAgICAgICAgICAgICsgJyI+PGkgY2xhc3M9ImZhIGZhLXBsYXkiPjwvaT48L2E+PC90ZD4nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRwbCArPSAnPHRkPk4vQTwvdGQ+JzsKICAgICAgICB9CiAgICAgICAgdHBsICs9ICc8L3RyPic7CiAgICAgICAgcmV0dXJuIHRwbDsKICAgIH0KCiAgICAvLyBhZGQgdGV4dCByZXNwb25zZXMgdG8gYSB0YWJsZQogICAgZnVuY3Rpb24gZnJlZVRleHQocmVzdWx0cykgewogICAgICAgIHZhciAkcmVzcG9uc2VzID0gJCgnI3R1cnRsZVJlc3BvbnNlcycpOwogICAgICAgIHZhciBjb250ZW50ID0gJyc7CiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSByZXN1bHRzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICAgICAgdmFyIHR1cnRsZVJlc3BvbnNlID0gcmVzdWx0c1tpXS5yZXNwb25zZXNbMl07CiAgICAgICAgICAgIGNvbnRlbnQgKz0gcm93KHR1cnRsZVJlc3BvbnNlKTsKICAgICAgICB9CiAgICAgICAgJHJlc3BvbnNlcy5hcHBlbmQoY29udGVudCk7CiAgICB9CgogICAgLy8gTG9hZCBjdXJyZW50IHJlc3VsdHMgZnJvbSBzZXJ2ZXIKICAgICQuYWpheCh7CiAgICAgICAgdXJsOiAnL3Jlc3VsdHMnLAogICAgICAgIG1ldGhvZDogJ0dFVCcKICAgIH0pLmRvbmUoZnVuY3Rpb24oZGF0YSkgewogICAgICAgIC8vIFVwZGF0ZSBjaGFydHMgYW5kIHRhYmxlcwogICAgICAgICQoJyN0b3RhbCcpLmh0bWwoZGF0YS5yZXN1bHRzLmxlbmd0aCk7CiAgICAgICAgbGVtdXJzKGRhdGEucmVzdWx0cyk7CiAgICAgICAgYWdlcyhkYXRhLnJlc3VsdHMpOwogICAgICAgIGZyZWVUZXh0KGRhdGEucmVzdWx0cyk7CiAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycikgewogICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgYWxlcnQoJ2ZhaWxlZCB0byBsb2FkIHJlc3VsdHMgZGF0YSA6KCcpOwogICAgfSk7Cn0pOw==</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>